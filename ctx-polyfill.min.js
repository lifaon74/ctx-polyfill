(function(){if(CanvasRenderingContext2D.useSvgMatrix===void 0){CanvasRenderingContext2D.useSvgMatrix=false}CanvasRenderingContext2D.arrayToSVGMatrix=function(t){var r=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();r.a=t[0];r.b=t[1];r.c=t[2];r.d=t[3];r.e=t[4];r.f=t[5];return r};CanvasRenderingContext2D.svgMatrixToArray=function(t){if(!(t instanceof SVGMatrix))throw new Error("Matrix is not a SVGMatrix");return[t.a,t.b,t.c,t.d,t.e,t.f]}})();(function(){var t=CanvasRenderingContext2D.prototype;if(!("resetTransform"in t)){t.resetTransform=function(){this.setTransform(1,0,0,1,0,0)}}if(!("currentTransform"in t)){if("mozCurrentTransform"in t){Object.defineProperty(t,"currentTransform",{get:function(){return CanvasRenderingContext2D.useSvgMatrix?CanvasRenderingContext2D.arrayToSVGMatrix(this.mozCurrentTransform):this.mozCurrentTransform},set:function(t){this.mozCurrentTransform=CanvasRenderingContext2D.useSvgMatrix?CanvasRenderingContext2D.svgMatrixToArray(t):t},enumerable:true,configurable:true})}else{var r=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(t,e){var a=r.call(this,t,e);switch(t){case"2d":Object.defineProperties(a,{_transformStack:{value:[],configurable:true,writable:true},_transformMatrix:{value:[1,0,0,1,0,0],configurable:true,writable:true}});break}return a};Object.defineProperty(t,"currentTransform",{get:function(){return CanvasRenderingContext2D.useSvgMatrix?CanvasRenderingContext2D.arrayToSVGMatrix(this._transformMatrix):this._transformMatrix},set:function(t){t=CanvasRenderingContext2D.useSvgMatrix?CanvasRenderingContext2D.svgMatrixToArray(t):t;this._transformMatrix=t;this.setTransform(t[0],t[1],t[2],t[3],t[4],t[5])},enumerable:true,configurable:true});var e=t.translate;t.translate=function(t,r){var a=this._transformMatrix;a[4]=a[0]*t+a[2]*r+a[4];a[5]=a[1]*t+a[3]*r+a[5];e.call(this,t,r)};var a=t.scale;t.scale=function(t,r){var e=this._transformMatrix;e[0]*=t;e[1]*=t;e[2]*=r;e[3]*=r;a.call(this,t,r)};var n=t.rotate;t.rotate=function(t){var r=Math.cos(t);var e=Math.sin(t);var a=this._transformMatrix;this._transformMatrix=[a[0]*r+a[2]*e,a[1]*r+a[3]*e,a[0]*-e+a[2]*r,a[1]*-e+a[3]*r,a[4],a[5]];n.call(this,t)};var i=t.transform;t.transform=function(t,r,e,a,n,o){var s=this._transformMatrix;this._transformMatrix=[s[0]*t+s[2]*r,s[1]*t+s[3]*r,s[0]*e+s[2]*a,s[1]*e+s[3]*a,s[0]*n+s[2]*o+s[4],s[1]*n+s[3]*o+s[5]];i.call(this,t,r,e,a,n,o)};var o=t.setTransform;t.setTransform=function(t,r,e,a,n,i){this._transformMatrix=[t,r,e,a,n,i];o.call(this,t,r,e,a,n,i)};var s=t.resetTransform;t.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0];s.call(this)};var f=t.save;t.save=function(){this._transformStack.push(this._transformMatrix);this._transformMatrix=this._transformMatrix.slice(0,6);f.call(this)};var h=t.restore;t.restore=function(){var t=this._transformStack.pop();if(t){this._transformMatrix=t}h.call(this)}}}if(!("imageSmoothingEnabled"in t)){Object.defineProperty(t,"imageSmoothingEnabled",{get:function(){if(this.mozImageSmoothingEnabled!==void 0){return this.mozImageSmoothingEnabled}else if(this.webkitImageSmoothingEnabled!==void 0){return this.webkitImageSmoothingEnabled}else if(this.msImageSmoothingEnabled!==void 0){return this.msImageSmoothingEnabled}else{return true}},set:function(t){if(this.mozImageSmoothingEnabled!==void 0){this.mozImageSmoothingEnabled=t}else if(this.webkitImageSmoothingEnabled!==void 0){this.webkitImageSmoothingEnabled=t}else if(this.msImageSmoothingEnabled!==void 0){this.msImageSmoothingEnabled=t}},enumerable:true,configurable:true})}if(!("ellipse"in t)){t.ellipse=function(t,r,e,a,n,i,o,s){this.save();this.translate(t,r);this.rotate(n);this.scale(e,a);this.arc(0,0,1,i,o,s);this.restore()}}})();(function(){if(!("Path2D"in window)||!("addPath"in window.Path2D.prototype)){window.Path2D=function(t){Object.defineProperty(this,"_operations",{value:[]});if(t instanceof Path2D){this.addPath(t)}};var t=window.Path2D.prototype;["arc","arcTo","bezierCurveTo","closePath","ellipse","lineTo","moveTo","quadraticCurveTo","rect"].forEach(function(r){t[r]=function(){this._operations.push({type:r,arguments:Array.prototype.slice.call(arguments,0)})}});var r=CanvasRenderingContext2D.prototype;["fill","stroke","clip","isPointInPath","isPointInStroke"].forEach(function(t){var e=r[t];r[t]=function(t){if(t instanceof Path2D){this.beginPath();var a;for(var n=0,i=t._operations.length;n<i;n++){a=t._operations[n];r[a.type].apply(this,a.arguments)}e.apply(this,Array.prototype.slice.call(arguments,1))}else{e.apply(this,arguments)}}});if(!("addPath"in t)){t.addPath=function(r,e){if(e!==void 0){this._operations.push({type:"save",arguments:[]});this._operations.push({type:"transform",arguments:CanvasRenderingContext2D.useSvgMatrix?CanvasRenderingContext2D.svgMatrixToArray(e):e})}var a;for(var n=0,i=r._operations.length;n<i;n++){a=r._operations[n];t[a.type].apply(this,a.arguments)}if(e!==void 0){this._operations.push({type:"restore",arguments:[]})}}}}})();